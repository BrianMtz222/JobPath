<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Principal</title>
  <link rel="stylesheet" href="index.css" />
</head>

<body>
  <script src="/js/translate.js"></script>

  <header class="header">
    <div class="logo">
      <img src="../JobPath/img/logo.png" alt="Anima logo" />
      Anima
    </div>
    <nav>
      <a href="home/home.html" class="active">PRINCIPAL</a>
      <a href="https://brianmtz222.github.io/JobPath/registro/login.html" id="perfil-link">INICIAR SESIÓN</a>
      <a href="//brianmtz222.github.io/JobPath/OrientacionV/Vac">ORIENTACIÓN VOCACIONAL</a>
    </nav>
  </header>

  <div class="container">
    <h1 class="title">JobPath</h1>
    <div class="arrow">&#8595;</div>
  </div>

<script>
const GO = () => {
  // Use a relative path if possible, or keep the absolute one if necessary
  location.href = 'home/home.html'; 
};

const userName = localStorage.getItem('userName');
const isLoggedIn = userName && userName.trim() !== '';
let done = false;

// Function to stop listening for events
function removeListeners() {
  window.removeEventListener('scroll', handleInteraction);
  window.removeEventListener('wheel', handleInteraction);
  window.removeEventListener('touchmove', handleInteraction);
  window.removeEventListener('keydown', handleKeyDown);
}

// Handler function that runs the logic
function handleInteraction() {
  if (isLoggedIn || done) return;
  
  done = true;
  removeListeners(); // Stop listening immediately
  GO();
}

// Separate keydown handler to check the key
function handleKeyDown(e) {
  if (['ArrowDown', 'PageDown', ' '].includes(e.key) || e.code === 'Space') {
    handleInteraction();
  }
}

// Only attach listeners if the user is NOT logged in
if (!isLoggedIn) {
  window.addEventListener('scroll', handleInteraction, { passive: true });
  window.addEventListener('wheel', handleInteraction, { passive: true });
  window.addEventListener('touchmove', handleInteraction, { passive: true });
  window.addEventListener('keydown', handleKeyDown);
}

// Script to update the navigation link
document.addEventListener('DOMContentLoaded', () => {
  const perfilLink = document.getElementById('perfil-link');
  if (!perfilLink) return;

  if (isLoggedIn) {
    perfilLink.textContent = 'PERFIL';
    perfilLink.href = 'perfil/perfil.html'; // Use relative path for consistency
  } else {
    perfilLink.textContent = 'INICIAR SESIÓN';
    perfilLink.href = 'https://brianmtz222.github.io/JobPath/registro/login.html';
  }
});
</script>

</body>
</html>
